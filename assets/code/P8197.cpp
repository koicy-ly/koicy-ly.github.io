/*
\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 \u2227\uff3f\u2227
\u3000\u3000\u3000\u3000\u3000 \u2227\uff3f\u2227 \u3000\uff08\u00b4<_\uff40 \uff09\u3000 Welcome to My Coding Space ^_^
\u3000\u3000\u3000\u3000 \uff08 \u00b4_\u309d`\uff09\u3000/\u3000 \u2312i
\u3000\u3000\u3000\u3000\uff0f\u3000\u3000\u3000\uff3c\u3000 \u3000  |\u3000|
\u3000\u3000\u3000 /\u3000\u3000 /\uffe3\uffe3\uffe3\uffe3/\u3000|\u3000|
\u3000 \uff3f_(__\uff86\u3064/\u3000\u3000 \u3000 / .| .|\uff3f\uff3f\uff3f\uff3f
\u3000 \u3000\u3000\u3000\uff3c/\uff3f\uff3f\uff3f\uff3f/\u3000\uff08u\u3000\u2283
*/

#include <cstdint>
#include <iostream>
#include <set>

using namespace std;
using tp = int64_t;
constexpr tp Hat_N = 1e3 + 3;

tp v1[Hat_N], v2[Hat_N];

void Core() {
  multiset<tp> s1, s2;
  tp n;
  cin >> n;
  for (tp i = 1; i <= n; ++i) {
    cin >> v1[i];
    s1.insert(v1[i]);
  }
  for (tp i = 1; i <= n; ++i) {
    cin >> v2[i];
    s2.insert(v2[i]);
  }
  if (s1 != s2) {
    puts("NO");
    return;
  }
  puts("YES");
  for (tp i = n; i; --i) {
    tp loc;
    for (tp j = 1; j <= i; ++j) {
      if (v1[j] == v2[i]) {
        loc = j;
      }
    }
    while (loc < i) {
      cout << loc << ' ' << loc + 1 << '\n';
      swap(v1[loc], v1[loc + 1]);
      ++loc;
    }
  }
  puts("0 0");
}

signed main(/* >_< */) {
  tp __TEST_CASE__;
  cin >> __TEST_CASE__;
  while (__TEST_CASE__--) {
    Core();
  }
  return 0;
}

/*#################################################################
#.................................................................#
#.............#......#............Created.By.RBTree...............#
#............#.#....#.#........... Limiting-Factor................#
#.............########............................................#
#............#........#..##############################...........#
#...........#..V....V......#..#........................#..#...#...#
#............#........#....#..........###..###..........#..#.#.#..#
#............#..X##X..#..#............#....#.#...........#..#...#.#
#...........#...N##N...#..#...........###..###..........#.........#
#.......MOO..#..@.....#....#.#.#.#...................#.#..........#
#.............########.....#.#.#.##############.#.#..#.#..........#
#..........................#.#.#.#.............#.#.#.#.#..........#
#......#########...........#.#.#.#.................#.#.#..........#
#.....#.........#..........#.#.#.#.................#.#.#..........#
#.#.#.#G#R#A#S#S#.#.#......#.#.#.#.................#.#.#..........#
#.###################......#.#.#.#.................#.#.#..........#
#...........................#.#.#...................#.#...........#
#.................................................................#
#################################################################*/